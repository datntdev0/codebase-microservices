# Database Migration Guideline

This document provides guidelines for performing database migrations in our project. It covers best practices, tools, and steps to ensure smooth transitions between database schema versions.

Prerequisites: You should have the EF Core CLI tools installed. If you haven't installed them yet, you can do so by running the following command:

```
dotnet tool install --global dotnet-ef --version 9.0.11
```

## When you need to update the database schema, follow these steps:

1. Update the database context in the `Web.App` project.
2. Create a new migration using the Entity Framework Core CLI on the `Migrator` project directory:
   ```bash
   dotnet ef migrations add <MigrationName> --output-dir Migrations/<MicroserviceName> --context <DbContext>
   ```
3. Apply the migration to the database by running the `Migrator` project, which includes schema migrations and data seeding.

## Squash migrations into a single migration
 
1. Remove all existing migrations from the `Migrations` folder in the `Migrator` project directory.
   ```bash
   dotnet ef migrations remove --context <DbContext>
   ```
2. Create a new migration that captures the current state of the database schema:
   ```bash
   dotnet ef migrations add <MigrationName> --output-dir Migrations/<MicroserviceName> --context <DbContext>
   ```
